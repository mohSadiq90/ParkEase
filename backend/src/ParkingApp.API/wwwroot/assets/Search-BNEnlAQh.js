import{b as f,r as i,c as y,j as e,L as S}from"./index-B2BqGpJW.js";import{S as b,I as T}from"./indianStatesCities-CpLRmfdt.js";const g=["Open","Covered","Garage","Street","Underground"],P=["Car","Motorcycle","SUV","Truck","Van","Electric"];function k(){const[p]=f(),[o,x]=i.useState([]),[u,d]=i.useState(!1),[m,j]=i.useState(!1),[s,t]=i.useState({state:"",city:p.get("city")||"",address:"",minPrice:"",maxPrice:"",parkingType:"",vehicleType:"",minRating:"",page:1,pageSize:12}),[c,v]=i.useState(1);i.useEffect(()=>{m&&h()},[s.page]);const h=async()=>{d(!0);try{const a=Object.fromEntries(Object.entries(s).filter(([,n])=>n!=="")),l=await y.searchParking(a);l.success&&l.data&&(x(l.data.parkingSpaces||[]),v(l.data.totalPages||1))}catch(a){console.error("Search error:",a)}d(!1)},N=a=>{a.preventDefault(),j(!0),t(l=>({...l,page:1})),h()},r=(a,l)=>{t(n=>({...n,[a]:l}))};return e.jsx("div",{className:"page",children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{style:{marginBottom:"1.5rem"},children:"Find Parking"}),e.jsx("div",{className:"card mb-3",children:e.jsx("form",{onSubmit:N,children:e.jsxs("div",{className:"grid grid-4",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"State"}),e.jsxs("select",{className:"form-select",value:s.state,onChange:a=>{t(l=>({...l,state:a.target.value,city:""}))},children:[e.jsx("option",{value:"",children:"Select State"}),b.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsxs("select",{className:"form-select",value:s.city,onChange:a=>r("city",a.target.value),disabled:!s.state,children:[e.jsx("option",{value:"",children:"Select City"}),s.state&&T[s.state]?.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Address/Area"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Street or area",value:s.address,onChange:a=>r("address",a.target.value)})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Parking Type"}),e.jsxs("select",{className:"form-select",value:s.parkingType,onChange:a=>r("parkingType",a.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),g.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Vehicle Type"}),e.jsxs("select",{className:"form-select",value:s.vehicleType,onChange:a=>r("vehicleType",a.target.value),children:[e.jsx("option",{value:"",children:"All Vehicles"}),P.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Min Price (â‚¹/hr)"}),e.jsx("input",{type:"number",className:"form-input",placeholder:"0",value:s.minPrice,onChange:a=>r("minPrice",a.target.value)})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Max Price (â‚¹/hr)"}),e.jsx("input",{type:"number",className:"form-input",placeholder:"1000",value:s.maxPrice,onChange:a=>r("maxPrice",a.target.value)})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Min Rating"}),e.jsxs("select",{className:"form-select",value:s.minRating,onChange:a=>r("minRating",a.target.value),children:[e.jsx("option",{value:"",children:"Any Rating"}),e.jsx("option",{value:"4",children:"4+ Stars"}),e.jsx("option",{value:"3",children:"3+ Stars"}),e.jsx("option",{value:"2",children:"2+ Stars"})]})]}),e.jsx("div",{className:"form-group",style:{margin:0,alignSelf:"flex-end"},children:e.jsx("button",{type:"submit",className:"btn btn-primary btn-full",children:"ğŸ” Search"})})]})})}),u?e.jsx("div",{className:"loading",children:e.jsx("div",{className:"spinner"})}):m?o.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ğŸ…¿ï¸"}),e.jsx("h3",{children:"No parking spaces found"}),e.jsx("p",{children:"Try adjusting your search filters"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-3",children:o.map(a=>e.jsx(S,{to:`/parking/${a.id}`,style:{textDecoration:"none",color:"inherit"},children:e.jsxs("div",{className:"card parking-card",children:[e.jsx("div",{className:"parking-image",children:"ğŸ…¿ï¸"}),e.jsx("h3",{className:"card-title",children:a.title}),e.jsxs("div",{className:"parking-location",children:["ğŸ“ ",a.address,", ",a.city]}),e.jsxs("div",{className:"flex-between mt-1",children:[e.jsxs("div",{className:"parking-price",children:["â‚¹",a.hourlyRate,e.jsx("span",{children:"/hr"})]}),e.jsxs("div",{className:"rating",children:["â­ ",a.averageRating?.toFixed(1)||"New"]})]}),e.jsxs("div",{className:"parking-meta",children:[e.jsx("span",{className:"parking-tag",children:g[a.parkingType]||"Open"}),e.jsxs("span",{className:"parking-tag",children:[a.availableSpots," spots"]}),a.is24Hours&&e.jsx("span",{className:"parking-tag",children:"24/7"})]}),a.activeReservations&&a.activeReservations.length>0&&e.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"var(--radius-sm)",fontSize:"0.8rem"},children:[e.jsx("strong",{style:{color:"#ef4444"},children:"ğŸ”’ Reserved:"}),e.jsxs("ul",{style:{margin:"0.25rem 0 0 1rem",padding:0},children:[a.activeReservations.slice(0,3).map((l,n)=>e.jsxs("li",{style:{color:"var(--color-text-muted)"},children:[new Date(l.startDateTime).toLocaleDateString()," ",new Date(l.startDateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," â†’ ",new Date(l.endDateTime).toLocaleDateString()," ",new Date(l.endDateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]},n)),a.activeReservations.length>3&&e.jsxs("li",{style:{color:"var(--color-text-muted)"},children:["+",a.activeReservations.length-3," more reservations"]})]})]})]})},a.id))}),c>1&&e.jsxs("div",{className:"flex-center gap-2 mt-3",children:[e.jsx("button",{className:"btn btn-secondary",disabled:s.page<=1,onClick:()=>t(a=>({...a,page:a.page-1})),children:"â† Previous"}),e.jsxs("span",{children:["Page ",s.page," of ",c]}),e.jsx("button",{className:"btn btn-secondary",disabled:s.page>=c,onClick:()=>t(a=>({...a,page:a.page+1})),children:"Next â†’"})]})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ğŸ”"}),e.jsx("h3",{children:"Search for Parking"}),e.jsx("p",{children:"Enter a city or address and click search to find available parking spaces"})]})]})})}export{k as default};
